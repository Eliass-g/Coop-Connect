import{u as b,r as a,e as x,B as g,j as s,D as N}from"./app-DNWayCnB.js";import S from"./Chat-MI1Y82bC.js";import{h as w}from"./moment-BH_gi4k_.js";import{X as y,S as v,A as C}from"./x-Czy4mkC3.js";const k="http://localhost:8081",E=()=>{const n=b(),[t,c]=a.useState(null),d=x(e=>e.messages.unreadCount),m=x(e=>e.messages.recentMessages),[l,p]=a.useState(""),[h,r]=a.useState(""),[o,f]=a.useState(!1),[u,i]=a.useState(!0);a.useEffect(()=>{n(g())},[n]);const j=async()=>{if(l){try{const e=await N.get(`${k}/api/users/email?email=${l}`);e.data?(c(e.data),r(""),i(!1)):r("User not found")}catch{r("User not found")}setTimeout(()=>{r("")},3e3)}};return s.jsx(s.Fragment,{children:m?s.jsxs("div",{className:"flex h-screen",children:[s.jsxs("div",{className:`${u?"block":"hidden"} sm:block w-full sm:w-1/4 bg-gray-200 p-4 h-screen overflow-y-auto absolute sm:relative`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Chats"}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("button",{onClick:()=>f(!o),className:"p-1 bg-gray-300 rounded",children:o?s.jsx(y,{size:20}):s.jsx(v,{size:20})})})]}),o&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("input",{type:"text",placeholder:"Enter email...",value:l,onChange:e=>p(e.target.value),className:"p-1 border rounded w-full"}),s.jsx("button",{onClick:j,className:"p-1 bg-blue-500 text-white rounded",children:"Search"})]}),h&&s.jsx("p",{className:"text-red-500 text-sm",children:h}),m.map(e=>s.jsxs("div",{className:`p-2 my-2 cursor-pointer ${(t==null?void 0:t.id)===e.other_user.id?"bg-gray-400":"bg-white"} rounded-lg`,onClick:()=>{c(e.other_user),i(!1)},children:[e.other_user.name," ",d>0&&e.other_user.id===(t==null?void 0:t.id)&&s.jsxs("span",{children:["(",d,")"]}),s.jsx("p",{className:"text-sm text-gray-600",children:e!=null&&e.message?e.message.length>30?e.message.slice(0,30)+"...":e.message:"No messages yet"}),s.jsx("small",{className:"text-gray-400",children:e!=null&&e.created_at?w(e.created_at).fromNow():""})]},e.id))]}),s.jsx("div",{className:`w-full sm:w-3/4 bg-white ${u?"hidden":"block"} sm:block`,children:t?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>i(!0),className:"sm:hidden p-2 bg-gray-300",children:s.jsx(C,{size:20})}),s.jsx(S,{selectedUser:t})]}):s.jsx("p",{className:"text-center text-gray-500",children:"Select a user to start chatting."})})]}):s.jsx("p",{children:"No users found."})})},D=E;export{D as default};
